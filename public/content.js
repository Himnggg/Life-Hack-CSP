"use strict";(()=>{var i=class{constructor(){this.settings=null;this.profile=null;this.injectedScript=null;this.initialize()}async initialize(){chrome.runtime.onMessage.addListener((e,s,t)=>{this.handleMessage(e,s,t)});try{let e=await chrome.runtime.sendMessage({type:"GET_SETTINGS"});e?.settings&&(this.settings=e.settings,await this.loadProfile(),this.applySpoofing())}catch(e){console.error("Failed to get initial settings:",e)}}async loadProfile(){if(this.settings)try{let e=await chrome.runtime.sendMessage({type:"GET_PROFILES"});e?.profiles&&(this.profile=e.profiles[this.settings.selectedCountry])}catch(e){console.error("Failed to load profile:",e)}}handleMessage(e,s,t){switch(e.type){case"UPDATE_SPOOFING":this.settings=e.settings,this.profile=e.profile,this.applySpoofing(),t({success:!0});break}}applySpoofing(){if(!this.settings?.enabled||!this.profile){this.removeSpoofing();return}this.injectSpoofingScript()}injectSpoofingScript(){this.injectedScript&&this.injectedScript.remove(),this.injectedScript=document.createElement("script"),this.injectedScript.src=chrome.runtime.getURL("inject.js"),this.injectedScript.setAttribute("data-settings",JSON.stringify(this.settings)),this.injectedScript.setAttribute("data-profile",JSON.stringify(this.profile));let e=document.head||document.documentElement;e.insertBefore(this.injectedScript,e.firstChild)}removeSpoofing(){this.injectedScript&&(this.injectedScript.remove(),this.injectedScript=null)}};new i;})();
